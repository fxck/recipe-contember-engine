stages:
  - test:build
  - test:run

build:
  stage: test:build
  image: node:10

  script:
    - npm install
    - npm run bootstrap
    - npm run build

  artifacts:
    paths:
      - mangoweb/admin/node_modules
      - mangoweb/cms-api/dist
      - mangoweb/cms-api/node_modules
      - node_modules
      - packages/cms-api/dist
      - packages/cms-api/node_modules


test:pkg:api:
  stage: test:run
  image: node:10

  script:
    - cd packages/cms-api
    - npm test
